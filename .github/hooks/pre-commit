#!/bin/sh

formatting_results=$(poetry run black --check --line-length 100 . 2>&1 > /dev/null)
if [[ "$?" == "0" ]]; then
    echo "✅ Formatting"
else
    echo "❌ Formatting"
    echo "$formatting_results"
	exit 1
fi

linting_results=$(poetry run pylint src tests)
if [[ "$?" == "0" ]]; then
    echo "✅ Linting"
else
    echo "❌ Linting"
    echo "$linting_results"
	exit 1
fi

test_results=$(poetry run pytest tests/unit tests/integration --cov=src/package_name --cov-fail-under=90 --no-header --no-summary -qq --cov=src/package_name --cov-report term-missing:skip-covered --cov-branch --cov-fail-under=90)
if [[ "$?" == "0" ]]; then
	echo "✅ Unit/Integration Tests"
else
	echo "❌ Unit/Integration Tests"
	echo "$test_results"
	exit 1
fi